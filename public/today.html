<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-JKLYFEERNL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-JKLYFEERNL');
  </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Book Club Events Today | Find Events Happening Now</title>
  <meta name="description" content="Find book club events happening today across North America. Join in-person or online discussions. Updated daily with events from 66 libraries.">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://bookclub.bayareaselected.com/today.html">
  <meta property="og:title" content="Book Club Events Today | Find Events Happening Now">
  <meta property="og:description" content="Find book club events happening today across North America. Join in-person or online discussions.">

  <link rel="canonical" href="https://bookclub.bayareaselected.com/today.html">
  <link rel="stylesheet" href="css/styles.css">
</head>

<body>
  <header class="header">
    <div class="container">
      <div class="header-badge">
        <span class="badge-icon">âœ¨</span>
        <span class="badge-text" id="events-count">Loading...</span>
      </div>
      <h1 class="main-title">
        Book Club Events <span class="highlight">Today</span>
      </h1>
      <p class="subtitle">Join a book discussion happening today</p>
    </div>
  </header>

  <!-- Quick Navigation -->
  <section class="search-section">
    <div class="container">
      <div class="quick-filters">
        <a href="/" class="quick-filter-btn">
          <span class="btn-icon">ğŸŒ</span>
          <span>All Events</span>
        </a>
        <a href="/today.html" class="quick-filter-btn active">
          <span class="btn-icon">ğŸ”¥</span>
          <span>Today</span>
        </a>
        <a href="/tomorrow.html" class="quick-filter-btn">
          <span class="btn-icon">â˜€ï¸</span>
          <span>Tomorrow</span>
        </a>
        <a href="/this-month.html" class="quick-filter-btn">
          <span class="btn-icon">ğŸ“…</span>
          <span>This Month</span>
        </a>
        <a href="/next-month.html" class="quick-filter-btn">
          <span class="btn-icon">â©</span>
          <span>Next Month</span>
        </a>
        <a href="/online.html" class="quick-filter-btn">
          <span class="btn-icon">ğŸ’»</span>
          <span>Online</span>
        </a>
        <a href="/bayarea.html" class="quick-filter-btn">
          <span class="btn-icon">ğŸŒ‰</span>
          <span>Bay Area</span>
        </a>
      </div>
    </div>
  </section>

  <div class="results-info" id="results-info">Loading events...</div>

  <main class="table-container">
    <div class="table-wrapper">
      <table class="events-table" id="events-table">
        <thead>
          <tr>
            <th>Event Name</th>
            <th>Type</th>
            <th>Library</th>
            <th>Date & Time</th>
            <th>Day of Week</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody id="events-container">
          <tr><td colspan="6" style="text-align: center; padding: 40px;">Loading today's events...</td></tr>
        </tbody>
      </table>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <p>Data updated daily from library RSS feeds</p>
      <p style="margin-top: 8px; font-size: 13px;">Built with â¤ï¸ for book lovers everywhere</p>
    </div>
  </footer>

  <script src="js/utils.js"></script>
  <script>
    // Client-side filtering for today's events
    async function loadTodayEvents() {
      try {
        const response = await fetch('events.json');
        const data = await response.json();
        const allEvents = data.events || [];

        // Filter for today (generous range for timezones)
        const now = new Date();
        const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());
        todayStart.setHours(todayStart.getHours() - 12); // Cover all timezones
        const todayEnd = new Date(todayStart.getTime() + 38 * 60 * 60 * 1000);

        const todayEvents = allEvents.filter(event => {
          const eventDate = new Date(event.start_date);
          return eventDate >= todayStart && eventDate < todayEnd;
        });

        // Update count
        document.getElementById('events-count').textContent = `${todayEvents.length} Events Today`;
        document.getElementById('results-info').innerHTML = `Showing <span class="results-count">${todayEvents.length}</span> events today`;

        // Render events
        const container = document.getElementById('events-container');
        if (todayEvents.length === 0) {
          container.innerHTML = `
            <tr><td colspan="6">
              <div class="empty-state">
                <div class="empty-state-icon">ğŸ“š</div>
                <h3>No events today</h3>
                <p>Check out tomorrow's events or view all upcoming events!</p>
                <p style="margin-top: 16px;">
                  <a href="/" style="color: var(--primary-color);">â† View all events</a>
                </p>
              </div>
            </td></tr>
          `;
        } else {
          container.innerHTML = todayEvents.map(event => {
            const badge = event.is_virtual
              ? '<span class="type-badge online">ONLINE</span>'
              : '<span class="type-badge in-person">IN PERSON</span>';
            const weekSlots = generateWeekSlots(event.start_date, false);
            return `
              <tr>
                <td class="event-name">
                  <a href="event.html?id=${event.id}">${event.title}</a>
                </td>
                <td>${badge}</td>
                <td class="library-name">${event.library}</td>
                <td class="event-date">${formatDate(event.start_date)}</td>
                <td>${weekSlots}</td>
                <td>
                  <a href="event.html?id=${event.id}" class="details-link">View â†’</a>
                </td>
              </tr>
            `;
          }).join('');
        }
      } catch (error) {
        console.error('Error loading events:', error);
        document.getElementById('events-container').innerHTML =
          '<tr><td colspan="6" style="text-align: center; color: red;">Failed to load events</td></tr>';
      }
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadTodayEvents);
    } else {
      loadTodayEvents();
    }
  </script>
</body>
</html>
